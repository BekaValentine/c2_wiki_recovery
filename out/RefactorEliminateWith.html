<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Refactor Eliminate With
      </h1>
      <p>
        You may find that some other recordset or object is referenced more often,
        or that there are just too few references to the "With" object in its block
        to justify the "With ... End With" block.
      </p>
      <p>
        Great for eliminating the <a href="FeatureEnvy.html">FeatureEnvy</a> smell that "With" can paper over.
      </p>
      <p>
        Languages:
      </p>
      <ul>
        <li>
           <a href="VbClassic.html">VbClassic</a>
        </li>
        <li>
           Applies to any language supporting the "with" shorthand.  Such as...
          <ul>
            <li>
               <a href="PascalLanguage.html">PascalLanguage</a>
            </li>
          </ul>
        </li>
      </ul>
      <p>
        Related Refactorings:
      </p>
      <ul>
        <li>
           <a href="RefactorIntroduceWith.html">RefactorIntroduceWith</a> - to reintroduce "with" block, possibly for a different record.
        </li>
      </ul>
      <hr/>
      <p>
        In <a href="VbClassic.html">VbClassic</a>:
        from...
      </p>
      <code>
        With rsObject<br/>
        .Open ...<br/>
        If .RecordCount = 0 Then<br/>
        .AddNew<br/>
        !PK = value<br/>
        End If<br/>
        !Attr = value<br/>
        End With<br/>
      </code>
      <p>
        to...
      </p>
      <code>
        rsObject.Open ...<br/>
        If rsObject.RecordCount = 0 Then<br/>
        rsObject.AddNew<br/>
        rsObject!PK = value<br/>
        End If<br/>
        rsObject!Attr = value<br/>
      </code>
      <p>
        <a href="PascalLanguage.html">PascalLanguage</a>:
        from...
      </p>
      <code>
        with emp do<br/>
        begin<br/>
        name       := "Joe";<br/>
        status     := "X";<br/>
        with bday do<br/>
        begin<br/>
        month :=    6;<br/>
        day   :=   27;<br/>
        year  := 1958;<br/>
        end<br/>
        end<br/>
      </code>
      <p>
        to...
      </p>
      <code>
        emp.name       := "Joe";<br/>
        emp.status     := "X";<br/>
        emp.bday.month :=    6;<br/>
        emp.bday.day   :=   27;<br/>
        emp.bday.year  := 1958;<br/>
      </code>
      <hr/>
      <p>
        <strong>However</strong>
      </p>
      <code>
        With rsObject<br/>
        .Open ...<br/>
        If .RecordCount = 0 Then<br/>
        .AddNew<br/>
        !PK = value<br/>
        End If<br/>
        !Attr = value<br/>
        End With<br/>
      </code>
      <p>
        is immaculately clear, and prevents a lot of needless typing.  This particular example is one in which I <strong>would</strong> use a WITH construct if my language provided it.  Absolutely.
      </p>
      <hr/>
      <p>
        <a href="ContributorsList.html">ContributorsList</a>: <a href="JeffGrigg.html">JeffGrigg</a>, <em>(name of Pascal example author missing)</em>
      </p>
      <hr/>
      <p>
        [<a href="CategoryRefactoring.html">CategoryRefactoring</a>/<a href="RefactoringLanguage.html">RefactoringLanguage</a>]
      </p>
    </div>
  </body>
</html>