<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Obfuscated Python
      </h1>
      <p>
        Not easy, but clearly possible. Click on this page's title to see where this page is referenced from - there you may find some examples or discussion.
      </p>
      <hr/>
      <p>
        I disagree with "not easy".  While Python lends itself better than many other languages to writing clear code, there's nothing magical about the language that makes it hard to write code in the style of the <a href="InternationalObfuscatedCeeCodeContest.html">InternationalObfuscatedCeeCodeContest</a>.  What part of Python doesn't lend itself well to obfuscation?  I assume you're going to say syntactically-significant indentation, but that's not much of a deterrent.
      </p>
      <p>
        In fact, there are some language features that make obfuscation fun:
      </p>
      <ol>
        <li>
           Tab and space are both allowable in indentation whitespace, which means you can make blocks that look inverted.
        </li>
        <li>
           You can rebind methods, alter base classes, and overload pretty much anything in the language
        </li>
        <li>
           Combine nested scopes with lambdas to produce truly evil side effects
        </li>
        <li>
           If you're clever, you can write most of your code as a series of nested list comprehensions (making the second word of that phrase a lie)
        </li>
      </ol>
      <p>
        Others?
      </p>
      <p>
        <em>Sure! you have the great while..else for..else and try..else constructs! make fun with a  for..else with continue or break or "raise StopIteration"  and let the user guess where the control flow will appear.</em>
      </p>
      <p>
        <em>Also use `foo`, and overload __nonzero__. And name "self" with another name or pass it here and there.</em>
      </p>
      <hr/>
      <p>
        The fact that tab and space are both allowed only lets you make inverted-looking blocks if you can guarantee that the tab size isn't 8 for whoever's looking.
      </p>
      <p>
        There are a number of ways in which Python's harder than C to make obscure in IOCCC fashion.
      </p>
      <dl>
        <dt> </dt>
        <dd>There's no preprocessor.</dd>
      </dl>
      <dl>
        <dt> </dt>
        <dd>Python is strongly (but not statically) typed, so you can't play type-punning games.</dd>
      </dl>
      <dl>
        <dt> </dt>
        <dd>Function definitions are more clearly marked, via the <em>def</em> keyword.</dd>
      </dl>
      <dl>
        <dt> </dt>
        <dd>Statements and expressions are distinct, so that you can't put so much into the condition part of an <em>if</em> or a <em>while</em>.</dd>
      </dl>
      <dl>
        <dt> </dt>
        <dd>There's no C-like <em>for</em> statement.</dd>
      </dl>
      <p>
        That's not to say obfuscated Python is impossible. You can be obscure in any language at all, obviously. But Python offers much less scope for syntactic obfuscation, and in C syntactic obfuscation provides rather a lot of the fun.
      </p>
      <hr/>
      <p>
        Anyone want to try their hand at some obfuscated Python?  The backlinks are a good start...
      </p>
      <hr/>
      <p>
        Some other thoughts:
      </p>
      <code>
        - lambda(x,y):... is different from lambda x,y:<br/>
        - Use nested lists [a][b][c][d][e:f]<br/>
        - Type tricks can be done... int,str=str,int isn't exactly subtle, though<br/>
        - It's probably more stylish not to obfuscate using execs/evals and lambdas<br/>
        - Use a string as both code (via eval/exec) and data<br/>
        - Take advantage of readers' knowledge of other languages:<br/>
        n=2<br/>
        c=++n<br/>
        print n, c, n**c<br/>
      </code>
      <hr/>
      <code>
        - nested lambdas<br/>
        - redefine functions by assignment<br/>
        - make an single instance of the % operator used for both modulus and string formatting<br/>
        - same with +, * for addition, string concatenation, etc.<br/>
        - evade indentation enforcement by writing things in recursive pseudo-functional ways<br/>
        - do something like foo(bar(), baz()) where bar() redefines foo() and baz()<br/>
        - litter the code with numeric and string literals that look like they're doing something (but don't)<br/>
        - cause exceptions solely for the purpose of later extracting obscure data from them<br/>
      </code>
      <p>
        I don't know if this is exactly related since it's not intentionally obfuscated, but I've got a polyglot (in this case, legal C/C++, perl and Python, see also <a href="HelloPolyGlots.html">HelloPolyGlots</a>) quine (see <a href="QuineProgram.html">QuineProgram</a>) that has some pretty unreadable Python in it.  <a href="http://www.phong.org/bf/polyglotC++PerlPythonC.c">http://www.phong.org/bf/polyglotC++PerlPythonC.c</a>
      </p>
      <p>
        <em>Very nice (for some interpretation of the term ;-)</em>
      </p>
      <hr/>
      <code>
        # Here's an accumulator for 2.2 that has roughly a 1:6 evil:character ratio<br/>
        # It's not nearly at Perl or C levels, of course...<br/>
        class O(float):O,__new__=0,lambda O,_:O.__setattr__(O,"O",_+O.O)or O.O<br/>
      </code>
      <hr/>
      <p>
        See <<a href="http://www.python.org/cgi-bin/moinmoin/JustAnotherPythoneer">http://www.python.org/cgi-bin/moinmoin/JustAnotherPythoneer</a>> for various degrees of obfuscation of a simple task.
      </p>
      <hr/>
      <code>
        [#[#[#[#[#[#[#[#[# By <a href="TaroOgawa.html">TaroOgawa</a> #]#]#]#]#]#]#]#]#]<br/>
      </code>
      <code>
        globals()<br/>
        .update({   "______":<br/>
        lambda x:         globals()<br/>
        .update((         dict([[x]<br/>
      </code>
      <ul>
        <li>
          2])))}),   ______(((
        </li>
      </ul>
      <code>
        "Just")))<br/>
        ,______((   "another"<br/>
        )),______         ("Python"<br/>
        ),______(               "Hacker")<br/>
        ];print (               " ".join(<br/>
        [(Just),(         (another)<br/>
        ),(Python   ),Hacker]<br/>
        ));______<br/>
      </code>
      <p>
        <em>Cute, but it doesn't actually, you know, run or anything.</em>
        It does under Python 2.3+ [Hint: Make sure you copy EVERYTHING including the credit line]
      </p>
      <hr/>
      <p>
        Functional programming is your friend!
      </p>
      <p>
        Here's a fully-functional, English-aware version of "99 bottles" in Python. Enjoy. Additional bonus -- it fits on one line and doesn't use any cheap indentation or variable naming tricks.
      </p>
      <code>
        print <em>.join('%(pre)s%(num)s %(bot)s on the wall, %(nul)s %(bot)s,\n%(tak)s\n' % (lambda c,b:</em><br/>
        {'pre':[<em>,'%s %s on the wall.\n\n' % (c,b)][abs(cmp(c,'Ninety-nine'))],</em><br/>
        'num':c, 'nul':c.lower(), 'bot':b,<br/>
        'tak':['Go to the store and buy some more... Ninety-nine %s.' % b,'Take one down, pass it around,'][abs(cmp(x,0))]<br/>
        })((lambda x,o: [(['Twenty','Thirty','Forty','Fifty',<br/>
        'Sixty','Seventy','Eighty','Ninety'][x/10-2]+'-'+o.lower()).replace('-no more',<em>), o][int(x<20)])(x, ['No more','One','Two',</em><br/>
        'Three','Four','Five','Six','Seven','Eight',<br/>
        'Nine','Ten','Eleven','Twelve','Thirteen','Fourteen',<br/>
        'Fifteen','Sixteen','Seventeen','Eighteen','Nineteen'][[x,x%10][int(x>=20)]]),'bottle%s of beer' % [<em>,'s'][abs(cmp(x,1))])</em><br/>
        for x in xrange(99,-1,-1))<br/>
      </code>
      <p>
        -- <a href="IvanTkatchev.html">IvanTkatchev</a>
      </p>
      <p>
        <em>That would have been so much shorter if Python had </em><a href="CommonLisp.html">CommonLisp</a>'s FORMAT function...<em>  How so?</em>
      </p>
      <p>
        <a href="CommonLisp.html">CommonLisp</a>'s FORMAT has number-to-word conversion built in, but only for English.
      </p>
      <hr/>
      <p>
        Put code in docstrings and execute the file again minus the first line, reversing the blockquotes. Example:
      </p>
      <code>
        """<br/>
        print "This is the hidden code."<br/>
        """<br/>
        print "This is the normal code."<br/>
        import sys<br/>
        codeToExecute = <em></em><br/>
        f=open(sys.argv[0])<br/>
        f.next()<br/>
        exec(<em>.join(f))</em><br/>
        """<br/>
        print "More hidden code."<br/>
        """<br/>
        #"""<br/>
      </code>
      <p>
        Or simply
      </p>
      <code>
        def p(n):<br/>
        """print 'hidden code'"""<br/>
        return n**2<br/>
        exec(p.__doc__) # hidden code<br/>
      </code>
      <hr/>
      <p>
        Overwrite Fields
      </p>
      <p>
        from __future__ import print_function; <strong></strong>
        print(q[1]('t9(}zw|q}/>VzrP}/q|zaJ Q>V')),exit(0)#<strong></strong>
        q=lambda x,_=('c9*6iv"&s1[Y/`Oh7_|pEW:=!uT4+zeNl;Im\'X\\<-wabDMZ8ykgR@{r>B)~qKFdC3H0Q%,S}xVG](?^2#oPjJL.A$U fnt5'): type(<em>).__dict__['}VJ|(@J}>'.</em>
        translate(('_'*32+_+('__'*len(_))[:(1<<2)-1-(1<<8-2)]))](x,('_'*32+_+('__'*
        len(_))[:(1<<2)-1-(1<<8-2)]));globals()[q('11$C3qV}11')] = lambda _,q=q,__builtins__=__builtins__: __builtins__.__dict__[q('11$C3qV}11')](q(_));q2=(
        lambda globals=(lambda q=(lambda x: getattr(__import__('q('),x)): q): (lambda
        os, __import__=q: (globals()(__import__(os)))))(); q=[q2('q3>|')(__import__(
        '(P(').__dict__[q('JVR%')][0],0),q];q2('^93o')(3,0);raw_input();input()
      </p>
      <hr/>
      <p>
        Someone replaced the content of this page with a code listing. I have reverted the change, as the new content was vastly less helpful than what used to be here aside from as an overly verbose SelfDemonstratingArticle.
      </p>
      <hr/>
      <p>
        <a href="CategoryPython.html">CategoryPython</a>
      </p>
    </div>
  </body>
</html>