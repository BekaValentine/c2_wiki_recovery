<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Diffie Hellman Merkle
      </h1>
      <p>
        Often called the Diffie-Hellman key exchange protocol, it should more accurately be called a key-negotiation protocol. It uses an insecure channel to agree a secret key with another party. Diffie has suggested it should be called Diffie-Hellman-Merkle.
      </p>
      <p>
        See also <a href="http://en.wikipedia.org/wiki/Diffie-Hellman">http://en.wikipedia.org/wiki/Diffie-Hellman</a>
      </p>
      <hr/>
      <p>
        It works like this. Over the insecure channel <a href="AliceAndBob.html">AliceAndBob</a> agree a base, <strong>s</strong> and a modulus <strong>m</strong>.  The modulus should be a sodding enormous prime, and there are a few technical things to avoid. All calculations are understood to be done modulo <strong>m</strong>.
      </p>
      <p>
        Then Alice chooses a secret number <strong>a</strong> and computes <strong>A=s^a</strong>, and Bob chooses a secret number <strong>b</strong> and computes <strong>B=s^b</strong>.  These are then sent to each other.
      </p>
      <p>
        Alice receives <strong>B</strong> and computes <strong>k1 = B^a</strong> and Bob receives <strong>A</strong> and computes <strong>k2 = A^b</strong>.  Magically, <strong>k1==k2</strong> and that can be used as a key for a "normal" crypto system such as IDEA, Blowfish or whatever.
      </p>
      <p>
        In summary:
      </p>
      <ul>
        <li>
           Alice and Bob agree <strong>s</strong> and <strong>m</strong>
        </li>
        <li>
           Alice chooses <strong>a</strong> and computes <strong>A=s^a</strong>
        </li>
        <li>
           Bob chooses <strong>b</strong> and computes <strong>B=s^b</strong>.
        </li>
        <li>
           Alice receives <strong>B</strong> and computes <strong>k = B^a</strong>
        </li>
        <li>
           Bob receives <strong>A</strong> and computes <strong>k = A^b</strong>
        </li>
        <li>
           <strong>k</strong> is used as the key in a symmetric cipher.
        </li>
      </ul>
      <p>
        This works because the <a href="DiscreteLogarithmProblem.html">DiscreteLogarithmProblem</a> seems to be hard, and because
      </p>
      <dl>
        <dt> </dt>
        <dd>k1 = B^a</dd>
      </dl>
      <dl>
        <dt>	 </dt>
        <dd>= (s^b)^a</dd>
      </dl>
      <dl>
        <dt>	 </dt>
        <dd>= s^(b*a)</dd>
      </dl>
      <dl>
        <dt>	 </dt>
        <dd>= s^(a*b)</dd>
      </dl>
      <dl>
        <dt>	 </dt>
        <dd>= (s^a)^b</dd>
      </dl>
      <dl>
        <dt>	 </dt>
        <dd>= A^b</dd>
      </dl>
      <dl>
        <dt>	 </dt>
        <dd>= k2,</dd>
      </dl>
      <p>
        all arithmetic being done modulo <strong>m</strong>.
      </p>
      <p>
        This is, of course, prone to the "man-in-the-middle" attack, where someone sits in the middle and to each pretends to be the other.
      </p>
      <hr/>
      <p>
        <a href="CategoryCryptography.html">CategoryCryptography</a> <a href="CategoryMath.html">CategoryMath</a>
      </p>
    </div>
  </body>
</html>