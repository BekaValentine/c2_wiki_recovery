<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Expensive Set Up Smell
      </h1>
      <p>
        As in the "setUp()" of <a href="JavaUnit.html">JavaUnit</a>.
      </p>
      <p>
        From <a href="KentBeck.html">KentBeck</a> on the <a href="XpMailingList.html">XpMailingList</a>:
      </p>
      <p>
        "Reflect on your design practices. I have spent 8 years figuring out how to further decouple my objects to make them easier to test. Expensive setUp() is a design smell."
      </p>
      <hr/>
      <p>
        Unnecessary coupling is bad, of course. But testing real code instead of mocked code often requires extensive setup. This is not a smell unless the code is a blob. Getting around the setup by mocking means you aren't testing what needs to be tested. That is not just a smell; it's a stink.
      </p>
      <p>
        <em>Well, there's a trade-off, certainly. In my own experience I find that if I don't mock out some of what could be mocked out, I just write fewer tests, which exposes you to risk, too. Possibly other programmers might be more disciplined, but if I'm testing a command that commits to the database, writes to a log file, and sends out 25 emails, I'm going to test just that if I can have all the external services mocked out.</em>
      </p>
      <p>
        <em>You can test those non-mocked services, too. But in my experience it makes things easier to test them in their own test case classes, as opposed to implicitly through its clients. -- francis</em>
      </p>
      <hr/>
      <p>
        The other smell comes when you DON'T mock.
      </p>
      <p>
        To write feature A, you first write test A'.
      </p>
      <p>
        To add feature B to A, you write test B' that calls the same setUp as A'.
      </p>
      <p>
        To add feature C to B, you write test C' that calls the same setUp as B'.
      </p>
      <p>
        You have now coupled A to C!
      </p>
    </div>
  </body>
</html>