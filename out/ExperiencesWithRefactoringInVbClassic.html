<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Experiences With Refactoring In Vb Classic
      </h1>
      <p>
        <em>From </em><a href="RefactoringInVbClassic.html">RefactoringInVbClassic</a>:<em></em>
      </p>
      <p>
        I'm also starting to get into <a href="RefactoringInVbClassic.html">RefactoringInVbClassic</a>, though only in a limited sense.  I have a big program which is mostly written in Forms and Modules right now, and I confess that I wrote almost the whole thing myself over a four-year period, so I really don't have anybody else to blame.  Our next version is planned to be in Java, but we expect to maintain this version for a while yet.
      </p>
      <p>
        I am not doing strict refactoring right now, since I still haven't gotten my head around <a href="UnitTest.html">UnitTest</a>ing (how do you write unit tests for hundred-line functions?), but I am using the same principles, like ExtractFunction, <a href="MoveMethod.html">MoveMethod</a>, and <a href="ExtractClass.html">ExtractClass</a>.
      </p>
      <p>
        What I'm really doing, of course, is ConvertProceduralDesignToObjects, but I'm having trouble with the first step.  Almost as a footnote, the <a href="RefactoringBook.html">RefactoringBook</a> says to turn each table in your <a href="RelationalDatabase.html">RelationalDatabase</a> into a <a href="DumbDataObject.html">DumbDataObject</a>.  But the way our system is designed, many of our tables can be customized by the users to add and remove many of the fields (though not all) by editing the data dictionary.  Even then, I am trying to figure out how to convert a Recordset to a <a href="DumbDataObject.html">DumbDataObject</a>.  That's a refactoring I really need right now.
      </p>
      <hr/>
      <p>
        <em>Check out </em><a href="http://huizen.dds.nl/~w-p/article/wrtabrec.htm">http://huizen.dds.nl/~w-p/article/wrtabrec.htm</a> It is my view of encapsulating tables and records in collections and objects.<em> -- </em><a href="WillemBogaerts.html">WillemBogaerts</a>
      </p>
      <p>
        <em>I can only strongly encourage you to write </em><a href="UnitTest.html">UnitTest</a>s. I agree that the big functions are often hard to test, but the small routines you extract out of it should be much easier. I can only encourage <a href="TestFirstDesign.html">TestFirstDesign</a> too, as it makes your code more testable and therefore better "pluggable" to the rest of your code.<em></em>
      </p>
      <p>
        <em>I personally do not use any of the </em><a href="VbUnit.html">VbUnit</a> libraries, but have developed my own (<a href="VbUnit.html">VbUnit</a> just wouldn't install when I started unit-testing). If you want to see some examples of unit-tested projects, look at <a href="http://huizen.dds.nl/~w-p/download.htm.''">http://huizen.dds.nl/~w-p/download.htm.''</a>
      </p>
      <p>
        <em>Good luck!</em> -- <a href="WillemBogaerts.html">WillemBogaerts</a>
      </p>
      <hr/>
      <p>
        <em>...how do you write unit tests for hundred-line functions?</em>
      </p>
      <p>
        Start easy and then work your way up.  Go through the code and correct the structure.  Find elements inside some of those functions which repeat parts of themselves, or share parts in common with other functions.  Build smaller functions to take care of those tasks, unit test first.  Find groups of methods and put them into classes.  Fix the scope of their variables and then begin testing the classes.  Just start by building unit tests for your new functions, and then by the time the original functions work their way down to a more digestible size they'll be ready for testing.  Build all the smaller functions up around the idea that 'a function does <strong>one</strong> thing', and they'll be easier to test and integrate with existing functions. -- Aaron Cumming
      </p>
      <hr/>
      <p>
        <a href="CategoryVbClassic.html">CategoryVbClassic</a> <a href="CategoryRefactoring.html">CategoryRefactoring</a>
      </p>
    </div>
  </body>
</html>