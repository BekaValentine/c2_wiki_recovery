<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Diff Test
      </h1>
      <p>
        Maybe your <a href="UnitTest.html">UnitTest</a><strong>'s pay for themselves, or maybe they don't.  Sometimes it's hard to tell. However, there is another approach that always comes out way in the black, and I call it Diff-Testing.</strong>
      </p>
      <p>
        The concept is simple:  capture the output of a program's successful run, make some changes, compare the outputs (outputii?).  
      </p>
      <p>
        This takes just a minute to set up.  Literally.  Here, time me:
      </p>
      <code>
        ./run > out.green<br/>
        vim run<br/>
        ./run > out.questionable<br/>
        diff -u out.{green,questionable} | less -F<br/>
      </code>
      <ol>
        <li>
           seconds.  From no tests to some surprisingly thorough <a href="RegressionTest.html">RegressionTest</a><strong>'s.	And the first time it helps you catch a mistake you would've otherwise sent to a customer, it saved you time, possibly money, embarrassment, and an adrenal discharge.</strong>
        </li>
      </ol>
      <p>
        Usually during the first session I'll go ahead and put the above stuff in a script, probably even make a <a href="VimKeymap.html">VimKeymap</a> to do it for me.  That first line goes in a script called "./snapshot" or something - used after changes that intentionally affect output.  The bottom to are usually just "./test".  In this file, I like to have the unit tests run first, if they're present.  If they pass, go ahead and show the diff.
      </p>
      <p>
        <em>Problems:</em>
      </p>
      <p>
        Yes, it is possible to write bugs that this will not catch.  Not only in the theoretical "Can you ever really test everything?" sense... but in the "You should keep your brain turned on." sense.  You might have to run the program a large number of times to cover all combinations of significant conditions - 
      </p>
      <p>
        The main problem is retraining ourselves to run it between nice, atomic changes.  If you introduce a subtle bug, and then decide to toss in some noisy change (such as converting your output's tabs to spaces), you'll probably not have the patience to notice the diff.
      </p>
      <p>
        Another consideration is constantly-changing stuff, such as dates, randomly generated stuff (e.g., advertisements), external data.  If this is happening, you probably would benefit from a "diff-ignore" marker.  So, in HTML, you could wrap your random quote generator like this: <!--diffskip-->"It was the best of times..."<!--/diffskip-->	Then, in your snapshot <em>and</em> test, you filter anything between the two tags out.
      </p>
      <p>
        Also, it's slow.  This might <a href="DogFood.html">DogFood</a> you to optimize a bit, or it might just plain discourage execution of the script.  C'est la vie.
      </p>
      <p>
        <em>Not only is it a great way to get something off the ground quickly, also, a large percentage of the best regression test suites I've ever seen (and I've seen a lot) were elaborations on this idea. The worst regression test suites had no trace of this idea, no matter how fancy their gui.</em>
      </p>
      <p>
        <em>It's about regression, that's all, it's not the same topic as other kinds of tests.</em>
      </p>
      <hr/>
      <p>
        [ The following was deleted, presumably because it was considered personal-spam or something, however, I downloaded the tar file in question and looked it over, and it seems to me that it is on topic for this page. -- <a href="DougMerritt.html">DougMerritt</a> ]
      </p>
      <p>
        A simple example is R<strong>'yRes: </strong><a href="http://panoptic.com/rking/pkg/ryres.tgz,">http://panoptic.com/rking/pkg/ryres.tgz,</a> my resume scrift.  I feel nervous making changes to that thing without diffs, and the fact that I generate it from code makes me a little more nervous.  I slap down a little 5 minute test framework, and my fears are put to rest.  Also I keep it under <a href="VersionControl.html">VersionControl</a>, because I'm not crazy.  In case you don't use version control to keep everything that's important that's not absolutely immutable, you need to change your ways.  Don't <em>even</em> argue.
      </p>
      <p>
        <em>Yeah, I deleted it, because I'm the one that hosts the file, and after I left I thought it was spammish.  Here before too long I'll have a non-commercial link.</em>
      </p>
      <p>
        I actually like the fact that it's an unusual example: a resume. Such things can trigger creativity in others. But, as you like.
      </p>
    </div>
  </body>
</html>