<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Optimization Pattern
      </h1>
      <p>
        Informally, the logical extension of <a href="DesignPatterns.html">DesignPatterns</a> to the process of optimization.  Hopefully useful when doing <a href="ExtremeProgrammingForGames.html">ExtremeProgrammingForGames</a>.
      </p>
      <p>
        An <a href="OptimizationPattern.html">OptimizationPattern</a>, like a <a href="DesignPattern.html">DesignPattern</a>, is a specific family of solutions for a specific family of problems.  General advice about optimization is not an <a href="OptimizationPattern.html">OptimizationPattern</a>.  Please take the time to understand this distinction before contributing to these pages ... thanks!
      </p>
      <p>
        <a href="OptimizationPattern.html">OptimizationPattern</a>s belong to families.  These families break down as follows:
      </p>
      <ol>
        <li>
           Patterns which affect the code's behavior and therefore its specification
        </li>
        <li>
           Patterns which affect the code's algorithmic structure
        </li>
        <li>
           Patterns which affect the code's implementation and layout
        </li>
      </ol>
      <p>
        The first category includes such patterns as:
      </p>
      <ul>
        <li>
           <a href="DiscardSuperfluousPrecision.html">DiscardSuperfluousPrecision</a>
        </li>
        <li>
           <a href="DoTheSimplestThingThatCouldPossiblyWork.html">DoTheSimplestThingThatCouldPossiblyWork</a>
        </li>
      </ul>
      <p>
        For a good discussion of some ideas in this direction, see <a href="GrokTaskFirst.html">GrokTaskFirst</a>.  These patterns are dangerous, as they require a change in specification.  In <a href="ExtremeProgrammingForGames.html">ExtremeProgrammingForGames</a>, the programmer is forbidden to change the specification without permission from the client/user.
      </p>
      <p>
        The second and third are "true" optimizations, since they do not affect the code's behavior.  Some possible <a href="OptimizationPattern.html">OptimizationPattern</a>s are:
      </p>
      <ul>
        <li>
           <a href="FunctionalInversion.html">FunctionalInversion</a>
        </li>
        <li>
           <a href="LoopInvariantAnalysis.html">LoopInvariantAnalysis</a>
        </li>
        <li>
           <a href="NonuniformCallingConventions.html">NonuniformCallingConventions</a> (assembly programming only)
        </li>
        <li>
           <a href="UseLocalStorage.html">UseLocalStorage</a> (multiprocessor programming only - e.g. PlayStation2)
        </li>
        <li>
           InterlaceParallelCode (useful on pipelined CPUs)
        </li>
        <li>
           <a href="WriteItOutLonghand.html">WriteItOutLonghand</a>
          <ul>
            <li>
               FunctionInlining
            </li>
            <li>
               UnrollLoops
            </li>
          </ul>
        </li>
        <li>
           <a href="ConvertGathersToScatters.html">ConvertGathersToScatters</a> (applies to broadcast of data to multiple receivers - be they buffers or network nodes)
        </li>
        <li>
           <a href="CacheCalculations.html">CacheCalculations</a>
        </li>
        <li>
           DeferDecisionsUntilRuntime
        </li>
        <li>
           CalculateBeforeCompileTime
        </li>
      </ul>
      <p>
        And some good "rules of thumb" for optimization, which are not patterns in and of themselves, are found below:
      </p>
      <ul>
        <li>
           <a href="GrokTaskFirst.html">GrokTaskFirst</a>
        </li>
        <li>
           <a href="GrokTheProblemDomain.html">GrokTheProblemDomain</a>
        </li>
        <li>
           <a href="GrokTheCompiler.html">GrokTheCompiler</a>
        </li>
        <li>
           <a href="UseStorageSpacesWisely.html">UseStorageSpacesWisely</a> (In C, C++, Pascal)
        </li>
        <li>
           <a href="GrokCaching.html">GrokCaching</a>
        </li>
        <li>
           <a href="GrokAliasing.html">GrokAliasing</a>
        </li>
        <li>
           <a href="GrokBranching.html">GrokBranching</a>
        </li>
        <li>
           <a href="GrokLoops.html">GrokLoops</a>
        </li>
      </ul>
      <hr/>
      <p>
        Anyone care to expand on these and/or add to the list?
      </p>
      <p>
        How can we publish such patterns?  The "problem" statement is generally "the program is too slow" so that seems redundant.  [No.  I changed my mind.  The problem statement is "the program is too slow, because ..." which is discovered in profiling.]
      </p>
      <p>
        Also (see <a href="WriteItOutLonghand.html">WriteItOutLonghand</a>) the study of <a href="OptimizationPattern.html">OptimizationPattern</a>s might lead to better optimizing compilers, which would be a <a href="GoodThing.html">GoodThing</a> ... since we do not want to compromise code cleanliness with our manual optimizations.
      </p>
      <p>
        I'll contribute more when I can; pressures of work forbid today, and I am getting married next week ... see you guys in August ;) -- <a href="EddieEdwards.html">EddieEdwards</a>
      </p>
      <p>
        <em>Congratulations!</em>
      </p>
      <p>
        You should <a href="ProfileFirst.html">ProfileFirst</a>, to understand where the performance bottlenecks are, before applying any of the other patterns.
      </p>
      <hr/>
      <p>
        The program could also be bloated in physical footprint or runtime storage.
      </p>
      <p>
        <em>Do you mean, optimization is not simply about time; or do you mean </em><a href="OptimizeLater.html">OptimizeLater</a>? -- <a href="EddieEdwards.html">EddieEdwards</a><em></em>
      </p>
      <p>
        I mean optimization is not about time. It's often a SpeedVersusMemory trade off. For embedded systems, memory is often the winner. For example, <a href="PocketSmalltalk.html">PocketSmalltalk</a> scans the ROM for string constants in order to save memory, albeit slower. For Web applications, disk footprint (actually, bandwidth) is an important consideration, which is why Web designers lower the quality of their images so they compress better.
      </p>
      <p>
        Theoretically, optimization is achieving the maximal value given an evaluation function. But that's boring to talk about! -- <a href="SunirShah.html">SunirShah</a>
      </p>
      <p>
        <em>ROFL!  Technically you're absolutely correct, but it is pretty boring to talk about ;)  But you are right to point out that my implicit assumption is optimizing with time as the major variable ... that's my games heritage. -- </em><a href="EddieEdwards.html">EddieEdwards</a><em></em>
      </p>
      <hr/>
      <p>
        What form of optimization is this:
      </p>
      <p>
        The situation was a COBOL class, where given a database of records we had to perform some basic operations on all records, with a small tweak of needing to run an additional operation if the date was July-1.
      </p>
      <p>
        Most people wrote something like this:
      </p>
      <code>
        loop over record set<br/>
        do normal operation<br/>
        if current date = july 1<br/>
        do extra operation<br/>
        end if<br/>
        end loop<br/>
      </code>
      <p>
        while some people did this:
      </p>
      <code>
        loop over record set<br/>
        do normal operation<br/>
        end loop<br/>
      </code>
      <code>
        if current date = july 1<br/>
        loop over record set<br/>
        do extra operation<br/>
        end loop<br/>
        end if<br/>
      </code>
      <p>
        but I wrote this:
      </p>
      <code>
        if current date = july 1<br/>
        loop over record set<br/>
        do normal operation<br/>
        do extra operation<br/>
        end loop<br/>
        else<br/>
        loop over record set<br/>
        do normal operation<br/>
        end loop<br/>
        end if<br/>
      </code>
      <p>
        For some reason this was remarkable enough that I was called out to the front of the class to explain what I did. I thought it was damned obvious. (By the way, the code itself was almost certainly exactly that number of lines as above making it even more obvious.)
      </p>
      <p>
        <em>What form of optimization? Probably a premature one breaking the </em><a href="OnceAndOnlyOnce.html">OnceAndOnlyOnce</a> rule.<em> </em>
      </p>
      <p>
        Is there any other kind?
      </p>
      <p>
        <em>How does this break </em><a href="OnceAndOnlyOnce.html">OnceAndOnlyOnce</a>?  It seems to me that it <em>preserves</em> <a href="OnceAndOnlyOnce.html">OnceAndOnlyOnce</a>, by only performing the loop one time, either with or without the "special operation" depending on the date.<em> -- </em><a href="MikeSmith.html">MikeSmith</a>
      </p>
      <p>
        Seriously though .. it looks like <a href="WriteItOutLonghand.html">WriteItOutLonghand</a>.
      </p>
      <p>
        <em>It breaks </em><a href="OnceAndOnlyOnce.html">OnceAndOnlyOnce</a> because you specify the behaviors "loop over record set" and "do normal operation" in two places.  OAOO applies to writing (and maintaining) the code, not executing the code.  But I thought one of the givens of these optimization pages was that performance has been measured and optimization is required.  In this case, the violation of OAOO is necessary to meet the requirements (acceptable performance).  If the rest of the code is well-factored, it shouldn't impact maintenance too much. -- <a href="JonathanTang.html">JonathanTang</a><em></em>
      </p>
      <p>
        But the break of <a href="OnceAndOnlyOnce.html">OnceAndOnlyOnce</a> isn't the fault of the optimization.  Consider:
      </p>
      <code>
        if current date = "july 1"<br/>
        operation = normalOperation + extraOperation  //humor me :)<br/>
        else<br/>
        operation = normalOperation<br/>
      </code>
      <code>
        loop over record set<br/>
        operation<br/>
      </code>
      <p>
        Would seem to be OAOO.  
      </p>
      <hr/>
      <p>
        <a href="CategoryOptimization.html">CategoryOptimization</a>
      </p>
    </div>
  </body>
</html>