<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Refactor Replace Comment With Test Case
      </h1>
      <p>
        From the <a href="XpMailingList.html">XpMailingList</a>:
      </p>
      <p>
        The notion of "Replace Comment with {test case, assertion, whatever}" has been thrown around on this mailing list. Unfortunately, it's not in <a href="RefactoringImprovingTheDesignOfExistingCode.html">RefactoringImprovingTheDesignOfExistingCode</a>.
      </p>
      <p>
        The general notion is this: As you read through code, you understand bits and pieces of it (hopefully correctly). You begin to stick in comments where appropriate like:
      </p>
      <code>
        a.doSomething(b);    /* this increments a by b */<br/>
      </code>
      <p>
        Later on, once you've got enough comments to understand enough of the code at once, refactor out chunks of comments and create a test case that expresses in code what the non-executable comments expressed.
      </p>
      <p>
        The reason I suggest this two-pass method is because when you're reading code, to stop and write a test case really breaks the natural "rhythm" of code-reading. Sticking in a quick comment (or, writing a line number on a piece of paper with a quick memo to yourself) doesn't have that same chop-and-change effect on your mental process (well, at least I find this to be true for me ... <a href="YourMileageMayVary.html">YourMileageMayVary</a>).
      </p>
      <p>
        Try it out, see if it works for you. Otherwise, find another way. ;-)
      </p>
      <p>
        -- <a href="DossyShiobara.html">DossyShiobara</a>
      </p>
      <hr/>
      <p>
        When I am reading code how does the test case help me understand what's going on?
      </p>
      <hr/>
      <p>
        Is it a good idea to replace the comments in the test cases with new test cases? :)
      </p>
      <hr/>
      <p>
        <em>When I am reading code how does the test case help me understand what's going on?</em>
      </p>
      <p>
        The purpose of the test case is not to help you understand what's going on. I'm assuming the code reading happens in legacy code. If you write test cases after reading the code, you test the legacy code, so it's safer afterwards to refactor the legacy code (without breaking stuff).
        -- <a href="PeterDeBruycker.html">PeterDeBruycker</a>
      </p>
      <p>
        I read code all the time. Having something in a test case doesn't do me any good.
        Replacing a comment with a new method can often make sense, but this still doesn't document why.
      </p>
      <hr/>
      <p>
        Perhaps it is just the example shown (and it is a difficult job to create an example that is both easy to understand and meaningful), but I would probably just do the refactoring immediately. I consider refactorings such as renaming methods or extracting methods (without changing the extracted code!) as extremely low risk. I have usually found that these types of refactorings are necessary when trying to introduce test cases on legacy code.
      </p>
      <p>
        I agree that one needs to create test cases before performing more aggressive refactoring and that creating test cases for legacy code must be done. I just think that using comment replacement as a justification for test cases would sound extremely weak to those I must convince to write test cases.
      </p>
      <p>
        -- <a href="WayneMack.html">WayneMack</a>
      </p>
      <hr/>
      <p>
        I usually use comments as a hint to extract method. This can be done reliably in most IDE's. Normally I don't even run my test suite after doing this. -- Ed Larmore
      </p>
      <hr/>
      <p>
        See <a href="RefactoringLanguage.html">RefactoringLanguage</a>
      </p>
      <hr/>
      <p>
        <a href="CategoryRefactoring.html">CategoryRefactoring</a>
      </p>
    </div>
  </body>
</html>