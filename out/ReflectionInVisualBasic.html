<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Reflection In Visual Basic
      </h1>
      <p>
        Question:  How does one do "reflection" in Visual Basic?
      </p>
      <p>
        Answer:  Use COM "Type Library" information.
      </p>
      <p>
        <em>(Assumption:  We're talking about VB4 thru VB6 -- not VB7 / VB.Net, which does things entirely differently.  See </em><a href="ReflectionInDotNet.html">ReflectionInDotNet</a>)<em></em>
      </p>
      <hr/>
      <p>
        From the Yahoo XP discussion group:
      </p>
      <p>
        <a href="http://groups.yahoo.com/group/extremeprogramming/message/52628">http://groups.yahoo.com/group/extremeprogramming/message/52628</a>
      </p>
      <p>
        <strong><em>"A google groups search found a very consistent answer:  No, you can't do that in VB, [...]"</em></strong>
      </p>
      <p>
        Visual Basic 4..6 DLLs (and some EXEs) are COM servers. Embedded in 
        the executable file is a COM "Type Library" containing definitions of 
        all the public classes creatable from outside, along with their 
        interfaces, including methods and parameters. (Every VB class is a 
        COM interface.) Visual Studio comes with an "OLE Viewer" tool that 
        can display type library contents in IDL (Interface Definition 
        Language) syntax. IDL is C/C++ -like.
      </p>
      <p>
        In theory, any Windows program can call standard COM functions to 
        query the contents of a type library. But the functions are VB 
        unfriendly, so you can't call them directly. There's 
        an "unsupported" DLL in the VB6 installation that will give you 
        access. Microsoft put out a help file that documents its use, with 
        the usual disclaimers that they might change it on a whim. (.Net 
        made the whole issue moot.)
        -- <a href="JeffGrigg.html">JeffGrigg</a>
      </p>
      <p>
        "FILE: Tlbinf32.exe : Help Files for Tlbinf32.dll (Q224331)"
        <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q224331">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q224331</a>
      </p>
      <p>
        "Visual Basic: Inspect COM Components Using the TypeLib Information 
        Object Library"
        <a href="http://msdn.microsoft.com/msdnmag/issues/1200/TypeLib/TypeLib.asp">http://msdn.microsoft.com/msdnmag/issues/1200/TypeLib/TypeLib.asp</a>
        A pretty good article on browing Type Library information from VB6. 
        (December 2000)
      </p>
      <p>
        <em>I guess one could create reflection in VB, since the vbUnit guys did it. Hmmmm. Maybe I should look at the vbUnit code... -- Kay</em>
      </p>
      <p>
        To find it in <a href="VbUnitThree.html">VbUnitThree</a>...
        Download <a href="http://www.maasscomputer.de/vbunit/vbUnit3.06.02.Basic.zip">http://www.maasscomputer.de/vbunit/vbUnit3.06.02.Basic.zip</a>
        Look at 'vbUnit3\vbUnitFramework\Reflector.cls'
        -- <a href="JeffGrigg.html">JeffGrigg</a>
      </p>
      <hr/>
      <p>
        <a href="CategoryReflection.html">CategoryReflection</a>
      </p>
    </div>
  </body>
</html>