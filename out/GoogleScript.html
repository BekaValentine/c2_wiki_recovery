<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Google Script
      </h1>
      <p>
        A javascript that interacts with google to generate its results.
      </p>
      <code>
        ' gmail.vb - gets unread gmail as an atom feed<br/>
        ' for Alintex Script - www.alintex.com<br/>
        ' usage: ax(w)script [username] [password] gmail.vb<br/>
      </code>
      <code>
        imports System<br/>
        imports System.Net<br/>
        imports System.IO<br/>
        imports System.Text<br/>
      </code>
      <code>
        #region "Script"<br/>
      </code>
      <code>
        ' check commandline arguments<br/>
        if (args.Length < 2)<br/>
        print("gmail.vb - gets unread gmail as an atom feed")<br/>
        print("Usage: ax(w)script [username] [password] gmail.vb")<br/>
        return<br/>
        end if<br/>
      </code>
      <code>
        ' connect to gmail and retrieve the atom xml feed<br/>
        client = new WebClient<br/>
        bytes = Encoding.ASCII.GetBytes(args(0) & ":" & args(1))<br/>
        client.Headers.Add("Authorization", "Basic " & _<br/>
        Convert.ToBase64String(bytes))<br/>
      </code>
      <code>
        gmailUri = "<a href="https://gmail.google.com/gmail/feed/atom">https://gmail.google.com/gmail/feed/atom</a>"<br/>
        dim feedStream as Stream = client.OpenRead(gmailUri)<br/>
        reader = new StreamReader(feedStream)<br/>
        feedAsXml = reader.ReadToEnd()<br/>
        feedStream.Close()<br/>
      </code>
      <code>
        print(feedAsXml)<br/>
      </code>
      <code>
        #end region<br/>
      </code>
    </div>
  </body>
</html>