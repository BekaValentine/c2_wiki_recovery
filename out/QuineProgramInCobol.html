<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Quine Program In Cobol
      </h1>
      <p>
        See <a href="QuineProgram.html">QuineProgram</a>.
      </p>
      <hr/>
      <code>
        IDENTIFICATION DIVISION.                                         <br/>
        PROGRAM-ID. QUINE.                                              <br/>
        AUTHOR. DAVE BURT.                                              <br/>
        DATE-WRITTEN. 18-09-2002.                                       <br/>
        ENVIRONMENT DIVISION.                                            <br/>
        DATA DIVISION.                                                   <br/>
        WORKING-STORAGE SECTION.                                        <br/>
      </code>
      <ol>
        <li>
           WS.                                                          
          <ol>
            <li>
               WS-DATA.                                                    
              <ol>
                <li>
                   PIC X(40) VALUE "   09 PIC X(40) VALUE                   ".
                </li>
                <li>
                   PIC X(40) VALUE ".                                       ".
                </li>
                <li>
                   PIC X(40) VALUE "IDENTIFICATION DIVISION.                ".
                </li>
                <li>
                   PIC X(40) VALUE " PROGRAM-ID. QUINE.                     ".
                </li>
                <li>
                   PIC X(40) VALUE " AUTHOR. DAVE BURT.                     ".
                </li>
                <li>
                   PIC X(40) VALUE " DATE-WRITTEN. 18-09-2002.              ".
                </li>
                <li>
                   PIC X(40) VALUE "ENVIRONMENT DIVISION.                   ".
                </li>
                <li>
                   PIC X(40) VALUE "DATA DIVISION.                          ".
                </li>
                <li>
                   PIC X(40) VALUE " WORKING-STORAGE SECTION.               ".
                </li>
                <li>
                   PIC X(40) VALUE " 01 WS.                                 ".
                </li>
                <li>
                   PIC X(40) VALUE "  05 WS-DATA.                           ".
                </li>
                <li>
                   PIC X(40) VALUE "  05 WS-ARR PIC X(40)                   ".
                </li>
                <li>
                   PIC X(40) VALUE "    OCCURS 4 REDEFINES WS-DATA.         ".
                </li>
                <li>
                   PIC X(40) VALUE "  05 WS-INTS USAGE IS COMPUTATIONAL.    ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-NDX   PIC 9(4) VALUE ZERO.     ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-START PIC 9(4) VALUE 3.        ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-SPLIT PIC 9(4) VALUE 12.       ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-CNT   PIC 9(4) VALUE 51.       ".
                </li>
                <li>
                   PIC X(40) VALUE " 01 WS-OUT-REC.                         ".
                </li>
                <li>
                   PIC X(40) VALUE "  05 FILLER      PIC X(7) VALUE SPACES. ".
                </li>
                <li>
                   PIC X(40) VALUE "  05 WS-OUT-AREA.                       ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-OUT-PFX PIC X(22).             ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-OUT-Q1  PIC X.                 ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-OUT-STR PIC x(40).             ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-OUT-Q2  PIC X.                 ".
                </li>
                <li>
                   PIC X(40) VALUE "   09 WS-OUT-SFX PIC X.                 ".
                </li>
                <li>
                   PIC X(40) VALUE "PROCEDURE DIVISION.                     ".
                </li>
                <li>
                   PIC X(40) VALUE "  000-MAIN.                             ".
                </li>
                <li>
                   PIC X(40) VALUE "    PERFORM VARYING WS-NDX              ".
                </li>
                <li>
                   PIC X(40) VALUE "            FROM WS-START BY 1          ".
                </li>
                <li>
                   PIC X(40) VALUE "            UNTIL WS-NDX >= WS-SPLIT    ".
                </li>
                <li>
                   PIC X(40) VALUE "     MOVE WS-ARR(WS-NDX) TO WS-OUT-AREA ".
                </li>
                <li>
                   PIC X(40) VALUE "     DISPLAY WS-OUT-REC                 ".
                </li>
                <li>
                   PIC X(40) VALUE "    END-PERFORM                         ".
                </li>
                <li>
                   PIC X(40) VALUE "    MOVE WS-ARR(1) TO WS-OUT-PFX        ".
                </li>
                <li>
                   PIC X(40) VALUE "    MOVE QUOTE TO WS-OUT-Q1             ".
                </li>
                <li>
                   PIC X(40) VALUE "    MOVE QUOTE TO WS-OUT-Q2             ".
                </li>
                <li>
                   PIC X(40) VALUE "    MOVE WS-ARR(2) TO WS-OUT-SFX        ".
                </li>
                <li>
                   PIC X(40) VALUE "    PERFORM VARYING WS-NDX              ".
                </li>
                <li>
                   PIC X(40) VALUE "            FROM 1 BY 1                 ".
                </li>
                <li>
                   PIC X(40) VALUE "            UNTIL WS-NDX > WS-CNT       ".
                </li>
                <li>
                   PIC X(40) VALUE "     MOVE WS-ARR(WS-NDX) TO WS-OUT-STR  ".
                </li>
                <li>
                   PIC X(40) VALUE "     DISPLAY WS-OUT-REC                 ".
                </li>
                <li>
                   PIC X(40) VALUE "    END-PERFORM                         ".
                </li>
                <li>
                   PIC X(40) VALUE "    PERFORM VARYING WS-NDX              ".
                </li>
                <li>
                   PIC X(40) VALUE "            FROM WS-SPLIT BY 1          ".
                </li>
                <li>
                   PIC X(40) VALUE "            UNTIL WS-NDX > WS-CNT       ".
                </li>
                <li>
                   PIC X(40) VALUE "     MOVE WS-ARR(WS-NDX) TO WS-OUT-AREA ".
                </li>
                <li>
                   PIC X(40) VALUE "     DISPLAY WS-OUT-REC                 ".
                </li>
                <li>
                   PIC X(40) VALUE "    END-PERFORM                         ".
                </li>
                <li>
                   PIC X(40) VALUE "    STOP RUN.                           ".
                </li>
              </ol>
            </li>
            <li>
               WS-ARR PIC X(40)                                            
            </li>
          </ol>
        </li>
      </ol>
      <code>
        OCCURS 4 REDEFINES WS-DATA.                                  <br/>
      </code>
      <ol>
        <li>
           WS-INTS USAGE IS COMPUTATIONAL.                             
          <ol>
            <li>
               WS-NDX   PIC 9(4) VALUE ZERO.                              
            </li>
            <li>
               WS-START PIC 9(4) VALUE 3.                                 
            </li>
            <li>
               WS-SPLIT PIC 9(4) VALUE 12.                                
            </li>
            <li>
               WS-CNT   PIC 9(4) VALUE 51.                                
              <ol>
                <li>
                   WS-OUT-REC.                                                  
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li>
           FILLER      PIC X(7) VALUE SPACES.                          
        </li>
        <li>
           WS-OUT-AREA.                                                
          <ol>
            <li>
               WS-OUT-PFX PIC X(22).                                      
            </li>
            <li>
               WS-OUT-Q1  PIC X.                                          
            </li>
            <li>
               WS-OUT-STR PIC x(40).                                      
            </li>
            <li>
               WS-OUT-Q2  PIC X.                                          
            </li>
            <li>
               WS-OUT-SFX PIC X.                                          
            </li>
          </ol>
        </li>
      </ol>
      <code>
        PROCEDURE DIVISION.                                              <br/>
      </code>
      <ol>
        <li>
          -MAIN.                                                      
        </li>
      </ol>
      <code>
        PERFORM VARYING WS-NDX                                       <br/>
        FROM WS-START BY 1                                   <br/>
        UNTIL WS-NDX >= WS-SPLIT                             <br/>
        MOVE WS-ARR(WS-NDX) TO WS-OUT-AREA                          <br/>
        DISPLAY WS-OUT-REC                                          <br/>
        END-PERFORM                                                  <br/>
        MOVE WS-ARR(1) TO WS-OUT-PFX                                 <br/>
        MOVE QUOTE TO WS-OUT-Q1                                      <br/>
        MOVE QUOTE TO WS-OUT-Q2                                      <br/>
        MOVE WS-ARR(2) TO WS-OUT-SFX                                 <br/>
        PERFORM VARYING WS-NDX                                       <br/>
        FROM 1 BY 1                                          <br/>
        UNTIL WS-NDX > WS-CNT                                <br/>
        MOVE WS-ARR(WS-NDX) TO WS-OUT-STR                           <br/>
        DISPLAY WS-OUT-REC                                          <br/>
        END-PERFORM                                                  <br/>
        PERFORM VARYING WS-NDX                                       <br/>
        FROM WS-SPLIT BY 1                                   <br/>
        UNTIL WS-NDX > WS-CNT                                <br/>
        MOVE WS-ARR(WS-NDX) TO WS-OUT-AREA                          <br/>
        DISPLAY WS-OUT-REC                                          <br/>
        END-PERFORM                                                  <br/>
        STOP RUN.                                                    <br/>
      </code>
      <p>
        -- dave@burt.id.au
      </p>
      <p>
        Excuse: I was very bored, and saw on some QuineInManyLanguages Web site that such a thing was missing. If I recall correctly, this is version two. <a href="CobolLanguage.html">CobolLanguage</a> presents an interesting challenge in writing such things in a number of ways, not least of which is the line length limit. Also there is a shorter version by Tom Dawes-Gamble (a real COBOL programmer) at <a href="http://www.tmdg.co.uk/programing/quine.cbl.php">http://www.tmdg.co.uk/programing/quine.cbl.php</a>
      </p>
    </div>
  </body>
</html>