<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Stack Module In Vb Classic
      </h1>
      <p>
        Here is a stack written as a <a href="VbClassic.html">VbClassic</a> Module.  How could it be better?  Feel free to reuse as you see fit.
      </p>
      <hr/>
      <p>
        I find using a collection would be a simpler thing that could possibly work. Here are some tests and code for a generic and string stack -- <a href="ThomasEyde.html">ThomasEyde</a>:
      </p>
      <p>
        <em>Jun 15, 2002: I have removed duplication in CStack and changed naming conventions to a (hopefully) more Wiki friendly style. The tests are unchanged. Thanks for noticing. -- Thomas Eyde</em>
      </p>
      <p>
        <em>Easter, 2007: I don't know why I bother to do this when </em>ClassicVb is dead and all that, but I have my pride in published code. I have honed my skills over the years and I felt like refactor this code to reflect my current understanding:<em></em>
      </p>
      <ul>
        <li>
           One test pr concept
        </li>
        <li>
           Microsoftish naming conventions
        </li>
        <li>
           One responsibility pr class and member
        </li>
        <li>
           Place responsibilites where they belong
        </li>
      </ul>
      <p>
        The tests still do the same thing after the face-lift:
      </p>
      <code>
        '<br/>
        ' Module: AllTests<br/>
        '<br/>
        Option Explicit<br/>
      </code>
      <code>
        Public Sub Run()<br/>
        StackTests.Run<br/>
        StringStackTests.Run<br/>
        End Sub<br/>
      </code>
      <code>
        '<br/>
        ' Module: StackTests<br/>
        '<br/>
        Option Explicit<br/>
      </code>
      <code>
        Public Sub Run()<br/>
        NewStackIsEmpty<br/>
        PopEmptyStackReturnsEmpty<br/>
        PeekEmptyStackReturnsEmpty<br/>
        StackIsNotEmptyAfterPush<br/>
        PeekPushedItem<br/>
        PeekDoesntChangeStack<br/>
        PopPushedItem<br/>
        PopRemovesItemFromStack<br/>
        PushNumberToStack<br/>
        PushMixedTypesToStack<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub NewStackIsEmpty()<br/>
        Dim aStack As New CStack<br/>
        Debug.Assert aStack.IsEmpty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PopEmptyStackReturnsEmpty()<br/>
        Dim aStack As New CStack<br/>
        Debug.Assert aStack.Pop = Empty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PeekEmptyStackReturnsEmpty()<br/>
        Dim aStack As New CStack<br/>
        Debug.Assert aStack.Peek = Empty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub StackIsNotEmptyAfterPush()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push 1<br/>
      </code>
      <code>
        Debug.Assert Not aStack.IsEmpty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PeekPushedItem()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push 1<br/>
        Debug.Assert aStack.Peek = 1<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PeekDoesntChangeStack()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push 1<br/>
        aStack.Peek<br/>
      </code>
      <code>
        Debug.Assert Not aStack.IsEmpty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PopPushedItem()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push 1<br/>
        Debug.Assert aStack.Pop = 1<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PopRemovesItemFromStack()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push 1<br/>
        aStack.Pop<br/>
      </code>
      <code>
        Debug.Assert aStack.IsEmpty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PushNumberToStack()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push 1<br/>
        Debug.Assert aStack.Peek = 1<br/>
        Debug.Assert aStack.Pop = 1<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PushMixedTypesToStack()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push "one"<br/>
        aStack.Push 2<br/>
        aStack.Push New Collection<br/>
      </code>
      <code>
        Debug.Assert TypeOf aStack.Peek Is Collection<br/>
        Debug.Assert TypeOf aStack.Pop Is Collection<br/>
        Debug.Assert aStack.Peek = 2<br/>
        Debug.Assert aStack.Pop = 2<br/>
        Debug.Assert aStack.Peek = "one"<br/>
        Debug.Assert aStack.Pop = "one"<br/>
        End Sub<br/>
      </code>
      <code>
        '<br/>
        ' Module: StringStackTests<br/>
        '<br/>
        Option Explicit<br/>
      </code>
      <code>
        Public Sub Run()<br/>
        NewStackIsEmpty<br/>
        PopEmptyStackReturnsEmpty<br/>
        PeekEmptyStackReturnsEmpty<br/>
        StackIsNotEmptyAfterPush<br/>
        PushStringsToStack<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub NewStackIsEmpty()<br/>
        Dim aStack As New CStack<br/>
        Debug.Assert aStack.IsEmpty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PopEmptyStackReturnsEmpty()<br/>
        Dim aStack As New CStack<br/>
        Debug.Assert aStack.Pop = ""<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PeekEmptyStackReturnsEmpty()<br/>
        Dim aStack As New CStack<br/>
        Debug.Assert aStack.Peek = ""<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub StackIsNotEmptyAfterPush()<br/>
        Dim aStack As New CStack<br/>
        aStack.Push "one"<br/>
      </code>
      <code>
        Debug.Assert Not aStack.IsEmpty<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub PushStringsToStack()<br/>
        Dim aStack As New CStringStack<br/>
      </code>
      <code>
        aStack.Push "one"<br/>
        aStack.Push 2<br/>
      </code>
      <code>
        Debug.Assert aStack.Peek = "2"<br/>
        Debug.Assert aStack.Pop = "2"<br/>
        Debug.Assert aStack.Peek = "one"<br/>
        Debug.Assert aStack.Pop = "one"<br/>
        End Sub<br/>
      </code>
      <p>
        The stack got some minor changes:
      </p>
      <code>
        '<br/>
        ' Class: CStack<br/>
        '<br/>
        Option Explicit<br/>
      </code>
      <code>
        Private underlyingList As New Collection<br/>
      </code>
      <code>
        Public Sub Push(<a href="ByVal.html">ByVal</a> newValue As Variant)<br/>
        underlyingList.Add newValue<br/>
        End Sub<br/>
      </code>
      <code>
        Public Function Pop() As Variant<br/>
        If Not IsEmpty Then<br/>
        AssignNextValueTo Pop<br/>
        RemoveNext<br/>
        End If<br/>
        End Function<br/>
      </code>
      <code>
        Public Function Peek() As Variant<br/>
        If Not IsEmpty Then<br/>
        AssignNextValueTo Peek<br/>
        End If<br/>
        End Function<br/>
      </code>
      <code>
        Public Function IsEmpty() As Boolean<br/>
        IsEmpty = (NextIndex = 0)<br/>
        End Function<br/>
      </code>
      <code>
        Private Sub RemoveNext()<br/>
        If Not IsEmpty Then<br/>
        underlyingList.Remove NextIndex<br/>
        End If<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub AssignNextValueTo(<a href="ByRef.html">ByRef</a> aValue As Variant)<br/>
        If IsObject(underlyingList(NextIndex)) Then<br/>
        Set aValue = underlyingList(NextIndex)<br/>
        Else<br/>
        aValue = underlyingList(NextIndex)<br/>
        End If<br/>
        End Sub<br/>
      </code>
      <code>
        Private Property Get NextIndex() As Long<br/>
        NextIndex = underlyingList.Count<br/>
        End Property<br/>
      </code>
      <p>
        The string stack suffered only a few renames:
      </p>
      <code>
        '<br/>
        ' Class: CStringStack<br/>
        '<br/>
        Option Explicit<br/>
      </code>
      <code>
        Private underlyingStack As New CStack<br/>
      </code>
      <code>
        Public Sub Push(<a href="ByVal.html">ByVal</a> aValue As String)<br/>
        underlyingStack.Push aValue<br/>
        End Sub<br/>
      </code>
      <code>
        Public Function Pop() As String<br/>
        Pop = underlyingStack.Pop<br/>
        End Function<br/>
      </code>
      <code>
        Public Function Peek() As String<br/>
        Peek = underlyingStack.Peek<br/>
        End Function<br/>
      </code>
      <code>
        Public Function IsEmpty() As Boolean<br/>
        IsEmpty = underlyingStack.IsEmpty<br/>
        End Function<br/>
      </code>
      <hr/>
      <p>
        <em>I havent touched anything VB in years but surely this can be done better, from a reuse point of view? Does VB support the idea of an interface? (so you can have different classes which implement the stack protocol, and use them interchangably) Or genericity, so you can have a stack which only accepts a particular type?</em>
      </p>
      <p>
        Actually, yes VB does support the idea of an interface (see VisualBasicInterfaceInheritance). However, when I wrote this, I was practicing doing the least thing that could possible work.
        [<a href="DoTheSimplestThingThatCouldPossiblyWork.html">DoTheSimplestThingThatCouldPossiblyWork</a>]
        I will keep in mind that this should be an interface setup if I ever get around to building this as a COM object.
      </p>
      <hr/>
      <p>
        <em>Initial tests indicated that it works perfectly as an Access 97 Class Module, FYI</em>
      </p>
      <p>
        Maybee try to get rid of some of the repetition of MyList(MyList.Count), also Pop contains code that is in peek, it could call peek and then remove the last item in the collection. MyList.Count could maybe be a private property call StackTop or maybe not. But hell it works, its got tests and anyone with half a brain can understand it. You are in the top ten percentile of VB developers for usefullness.
      </p>
      <p>
        <em>Thank you for the kind words. It's been a while since I last read this page. I actually forgot I put some code here, but the fact that I can still read it is promising. Now that I read it, I agree: </em>MyList.Count is repetitious. -- <a href="ThomasEyde.html">ThomasEyde</a><em></em>
      </p>
      <hr/>
      <p>
        On the "Err.Raise" statements, it's good form to do
      </p>
      <code>
        Err.Raise vbObjectError + <app_number>, ...<br/>
      </code>
      <p>
        where "<app_number>" is some application-defined error number.
        [<a href="VbErrRaise.html">VbErrRaise</a>]
      </p>
      <hr/>
      <code>
        'this stack doesn't really deal with objects so well.<br/>
        'it is just fine with non object varients of all types<br/>
        'to make it an object stack should be easy though.<br/>
      </code>
      <code>
        Option Explicit<br/>
      </code>
      <code>
        'local variable(s) to hold property value(s)<br/>
        Private iCount As Integer 'local copy<br/>
      </code>
      <code>
        Private aryStack() As Variant<br/>
      </code>
      <code>
        Public Property Get Count() As Integer<br/>
        'used when retrieving value of a property, on the right side of an assignment.<br/>
        'Syntax: Debug.Print X.Count<br/>
        Count = iCount<br/>
        End Property<br/>
      </code>
      <code>
        Public Sub Push(ByVal vrtItem As Variant)<br/>
        If UBound(aryStack) = iCount Then Resize<br/>
        iCount = iCount + 1<br/>
        aryStack(iCount) = vrtItem<br/>
        End Sub<br/>
      </code>
      <code>
        Public Function Pop() As Variant<br/>
        Dim ret As Integer<br/>
        If iCount = 0 Then<br/>
        Err.Raise 5111, "Stack.Pop", "Programmer attempted to pop empty stack."<br/>
        Exit Function<br/>
        End If<br/>
        ret = iCount<br/>
        iCount = iCount - 1<br/>
        Pop = aryStack(ret)<br/>
        End Function<br/>
      </code>
      <code>
        Public Function Peek() As Variant<br/>
        Dim ret As Integer<br/>
        If iCount = 0 Then<br/>
        Err.Raise 5111, "Stack.Pop", "Programmer attempted to pop empty stack."<br/>
        Exit Function<br/>
        End If<br/>
        ret = iCount<br/>
        Peek = aryStack(ret)<br/>
        End Function<br/>
      </code>
      <code>
        Private Sub Resize()<br/>
        Dim temp As Integer<br/>
        temp = UBound(aryStack) * 2<br/>
        ReDim Preserve aryStack(1 To temp) As Variant<br/>
        End Sub<br/>
      </code>
      <code>
        Private Sub Class_Initialize()<br/>
        iCount = 0<br/>
        ReDim Preserve aryStack(1 To 10) As Variant<br/>
        End Sub<br/>
      </code>
      <hr/>
      <p>
        <a href="CategoryVbClassic.html">CategoryVbClassic</a>
      </p>
    </div>
  </body>
</html>