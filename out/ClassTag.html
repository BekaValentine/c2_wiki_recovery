<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Class Tag
      </h1>
      <p>
        Part of the <a href="ObjectBasedProgramming.html">ObjectBasedProgramming</a> pattern language. Discussion occurs on ClassTagDiscussion.
      </p>
      <p>
        Original at  <a href="http://www.geocities.com/SiliconValley/Foothills/5962/classtag.htm">http://www.geocities.com/SiliconValley/Foothills/5962/classtag.htm</a>
      </p>
      <hr/>
      <p>
        <strong>Intent</strong>
      </p>
      <p>
        Provide run-time object class identification. 
      </p>
      <p>
        <strong>Motivation</strong>
      </p>
      <p>
        Some other patterns described in this pattern language require the ability to determine the class of an object at run-time. A procedural language often has no built-in mechanism to determine the type of a data structure, hence it is impossible without help to uniquely distinguish the type of instance data. The ability to determine the class of an object must be provided externally. 
      </p>
      <p>
        <strong>Applicability</strong>
      </p>
      <p>
        Use the <a href="ClassTag.html">ClassTag</a> pattern when 
      </p>
      <ul>
        <li>
           There is a need to identify the class of an object in run-time 
        </li>
      </ul>
      <ul>
        <li>
           The <a href="ClassDescriptor.html">ClassDescriptor</a> pattern, or the <a href="PolymorphicFunctionWithEmbeddedBehaviour.html">PolymorphicFunctionWithEmbeddedBehaviour</a> pattern is applied.
        </li>
      </ul>
      <p>
        <strong>Solution</strong>
      </p>
      <p>
        Type information is added to the instance data so that the class of the object can be identified in run-time. The class information can be stored in any format as long as the type can be uniquely determined. Typical formats include: 
      </p>
      <ul>
        <li>
           An enumerated type enumerating the list of classes in the class hierarchy 
        </li>
        <li>
           An uncoded integer value 
        </li>
        <li>
           A pointer reference to the class descriptor describing the class 
        </li>
        <li>
           A coded integer value bit mapped to show the ancestors as well. 
        </li>
      </ul>
      <p>
        The type information must be stored in a fixed location in the instance data, so the polymorphic functions can access the type information without first knowing the structure of the instance data. A typical location is offset 0.
      </p>
      <p>
        It is important to note that it is not possible to access the class tag without knowledge of the instance data. As a result, unless the principal of encapsulation is broken, it is not possible for an external entity to directly determine the class of an object, even if this pattern is applied. If the class of an object is to be made externally available, the class family should be designed to support a corresponding operation. 
      </p>
      <p>
        <strong>Consequences</strong>
      </p>
      <p>
        The <a href="ClassTag.html">ClassTag</a> pattern has the one important consequence: 
      </p>
      <ol>
        <li>
           <em>Higher memory consumption.</em> The class tag is encoded in the instance data for each instance. 
        </li>
      </ol>
      <p>
        <strong>Sample Code</strong>
      </p>
      <p>
        Consider the following class family: 
      </p>
      <p>
        [1]                                                               
      </p>
      <p>
        For the sake of demonstration, we assume neither the <a href="FamilySplit.html">FamilySplit</a> pattern nor the <a href="FamilyFusion.html">FamilyFusion</a> pattern have been applied. Each subclass has its own instance data structure. 
      </p>
      <p>
        The <a href="ClassTag.html">ClassTag</a> pattern is applied. The location of the class tag is decided to be at offset 0 of the instance data. 
      </p>
      <p>
        The definition of the instance data structure would be as follows: 
      </p>
      <code>
        typedef struct { <br/>
        int nShapeClass, /* class tag */ <br/>
        } tsSHAPE; <br/>
      </code>
      <code>
        typedef struct { <br/>
        int nShapeClass, /* class tag */ <br/>
        int nWidth, <br/>
        int nLength <br/>
        } tsRECTANGLE; <br/>
      </code>
      <code>
        typedef struct { <br/>
        int nShapeClass, /* class tag */ <br/>
        int nRadius <br/>
        } tsCIRCLE; <br/>
      </code>
      <p>
        <strong>Known Uses</strong>
      </p>
      <p>
        This section is to be filled out. 
      </p>
      <p>
        <strong>Related Patterns</strong>
      </p>
      <p>
        The <a href="ClassTag.html">ClassTag</a> pattern is a pre-requisite of the <a href="PolymorphicFunctionWithEmbeddedBehaviour.html">PolymorphicFunctionWithEmbeddedBehaviour</a> pattern and the <a href="ClassDescriptor.html">ClassDescriptor</a> pattern. 
      </p>
      <hr/>
      <p>
        Category?
      </p>
    </div>
  </body>
</html>