<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Loop Invariant Analysis
      </h1>
      <p>
        Briefly, remove constant forms from inside loops -- <a href="EddieEdwards.html">EddieEdwards</a>
      </p>
      <hr/>
      <p>
        Your compiler does this for you. At least, it should. -- <a href="StephanHouben.html">StephanHouben</a>
      </p>
      <p>
        <em>Ideally it should, but usually the compiler doesn't know. You may be calling some external function, the typical beginner mistake in C being "</em>'for (int i = 0; i < strlen(text); ++i)<strong>". Assuming </strong>strlen(text)<em>' is constant, the compiler just has no simple way to verify it so it doesn't (it depends on if text is modified within the loop or even in another thread). It'd take a pretty damn smart compiler to optimize such invariants.</em>
      </p>
      <p>
        Even so, source code is often easier to understand if constant forms are outside the loop.  Minimizing the amount of stuff inside a loop makes it clearer.  The improvement in performance is an additional bonus. -- <a href="KrisJohnson.html">KrisJohnson</a>
      </p>
      <hr/>
      <p>
        <em>Is this the same as </em>CodeHoisting?<em></em>
      </p>
      <hr/>
      <p>
        I thought you were going to discuss inventing a loop by declaring its invariant. A much more fun discussion (e.g. see the ones in <a href="BinarySearchCodeOnly.html">BinarySearchCodeOnly</a>). -- <a href="AlistairCockburn.html">AlistairCockburn</a>
      </p>
      <hr/>
      <p>
        Relation to <a href="FixedPointCombinator.html">FixedPointCombinator</a> ?
      </p>
      <p>
        <em>It's not particularly related. The invariant under discussion is a constant, whereas fixed points concern variables that are invariant under a transformation. An example of the latter is x = f(x). It's x that is the fixed point. The fact that it's also true that 1*x = f(1 * x) doesn't make the constant 1 a fixed point. It's irrelevant to the issue.</em>
      </p>
      <p>
        <em>To put it another way, a fixed point is the solution to a relation (the word "solution" can be, and often has been, defined thusly). There may be only zero or one such. But loop invariants can exist even when there is no solution to the relation that the loop is searching for.</em>
      </p>
      <hr/>
      <p>
        This is an optimization of this form:
      </p>
      <p>
        for (loop conditions)
      </p>
      <code>
        const x = method()<br/>
        ...code...<br/>
      </code>
      <p>
        this can be optimized by moving to this form:
      </p>
      <p>
        const x = method()
        for (loop conditions)
      </p>
      <code>
        ...code...<br/>
      </code>
      <p>
        In other words, perform calculations with a constant result outside the loop to save an order of magnitude in performance.
      </p>
      <hr/>
      <p>
        See also <a href="ProofOfCorrectness.html">ProofOfCorrectness</a>, <a href="ProfileBeforeOptimizing.html">ProfileBeforeOptimizing</a>, <a href="DaikonInvariantDetector.html">DaikonInvariantDetector</a>
      </p>
      <p>
        <a href="CategoryOptimization.html">CategoryOptimization</a>
      </p>
    </div>
  </body>
</html>