<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Vb Err Raise
      </h1>
      <p>
        When "throwing application errors" in <a href="VisualBasic.html">VisualBasic</a> (prior to .Net / version 7)...
      </p>
      <p>
        On the "Err.Raise" statements, it's good form to do
      </p>
      <code>
        Err.Raise vbObjectError + <app_number>, ...<br/>
      </code>
      <p>
        where "<app_number>" is some application-defined error number.
      </p>
      <p>
        This will prevent your error numbers from conflicting with system-defined error numbers.
      </p>
      <hr/>
      <p>
        "You create custom errors by using the VB built-in vbObjectError constant, then adding an offset. Microsoft reserves error values between vbObjectError and vbObjectError + 512, so you must start custom errors at offset 513 or greater. The vbObjectError constant is equivalent to hex value 80040000, which prints out as value -2147221504 if you display its decimal equivalent. Therefore, it's often convenient to display custom errors as hex values (using the Hex$ function), as shown in the Class<strong>'Err routine."</strong>
        -- Visual Basic Programmer's Journal, January 2001, Volume 11, Issue 1 -- see <a href="http://www.vbpj.com">http://www.vbpj.com</a>
      </p>
      <hr/>
      <p>
        This is still fully supported in <a href="VisualBasicDotNet.html">VisualBasicDotNet</a>, but it's <strong>NOT</strong> the recommended way of doing exception handling in the <a href="DotNet.html">DotNet</a> environment:
        "StructuredErrorHandling", in the C#/Java "try-catch and throw" style is the recommended way of handling error exceptions in the <a href="DotNet.html">DotNet</a> environment.
      </p>
      <hr/>
      <hr/>
      <p>
        <em>Can you explain the reason why you'd want to raise an error with a particular number? If it gets displayed to a user, an error number means approximately nothing. The description is where meaning should be conveyed.</em>
      </p>
      <p>
        For errors that will be displayed to a user, sure.  However, if you're writing some library code and you need to signal an error condition to the calling application, then a number will often be easier for it to deal with than a textual message.    The Err.Raise statement is VB's interface to the standard HRESULT error handling in COM (<a href="ComponentObjectModel.html">ComponentObjectModel</a>).  
      </p>
      <hr/>
      <p>
        I think we should differ between public and private errors. With <em>private</em> I mean errors you don't see outside of your ActiveX component. I usually don't care much about the number and often use 999. The description field can contain any string, so we could use it to transfer xml or some other encoded values. As soon as the number means anything I would use vbObjectError + whatever constant.
      </p>
      <p>
        The most important thing is not to use anything which <a href="VbClassic.html">VbClassic</a> or system components reserves.
      </p>
      <p>
        -- <a href="ThomasEyde.html">ThomasEyde</a>
      </p>
      <hr/>
      <p>
        <em>[Seen on </em><a href="StackModuleInVbClassic.html">StackModuleInVbClassic</a>]<em></em>
      </p>
      <hr/>
      <p>
        <a href="CategoryVisualBasic.html">CategoryVisualBasic</a>
      </p>
    </div>
  </body>
</html>