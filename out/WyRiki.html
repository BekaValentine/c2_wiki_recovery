<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Wy Riki
      </h1>
      <p>
        An entry in the <a href="ShortestWikiContest.html">ShortestWikiContest</a>. <a href="WyRiki.html">WyRiki</a> is 20 lines of unreadable Ruby code. The design was shamelessly stolen from the <a href="WyPy.html">WyPy</a> entry. 
      </p>
      <p>
        You can see the code here: <a href="http://onestepback.org/misc/wyriki.txt.">http://onestepback.org/misc/wyriki.txt.</a>
      </p>
      <p>
        There is a live version at <a href="http://onestepback.org/cgi-bin/wyriki.">http://onestepback.org/cgi-bin/wyriki.</a>
      </p>
      <p>
        The author confesses to writing it late at night when his better judgment was impaired.  Plus, leaving off the final "i" in <a href="WyRiki.html">WyRiki</a> gives a phonetic spelling of the author's name (which is the real reason he wrote it).
      </p>
      <p>
        -- <a href="JimWeirich.html">JimWeirich</a>
      </p>
      <p>
        <em>Please add</em> wrap=soft <em>or</em> wrap=virtual <em>to the textarea definition.</em>
      </p>
      <hr/>
      <p>
        This source is from <a href="http://web.archive.org/web/20070222033318/http://onestepback.org/misc/wyriki.txt">http://web.archive.org/web/20070222033318/http://onestepback.org/misc/wyriki.txt</a> -- <a href="MarkusSrank.html">MarkusSrank</a>
      </p>
      <code>
        #!/usr/local/bin/ruby<br/>
        require 'cgi';def load(n) File.exist?("w/"+n) ? File.read("w/"+n) : <em> end</em><br/>
        def fs(s) s.gsub!(/\r/,<em>);s.gsub!(/^---/, "<hr>");s.gsub!(/^\{\{$/, "\n<ul>")</em><br/>
        s.gsub!(/^}}$/, "</ul>");s.gsub!(/^\* /, "<li>");s.gsub!(/\n\n/, "<p>")<br/>
        s.gsub!(/(^|[^A-Za-z0-9?])(([A-Z][a-z]+){2,})/) {$1+(File.exist?('w/'+$2) ?<br/>
        %{<a href="wyriki?#{$2}">#{$2}</a>}:$2+%[<a href="wyriki?p=#{$2}&amp;q=e">?]+<br/>
        %[</a>])};s.gsub!(/(ht|f)tp:[^<>"\s]+/){ %{<a href="#{$&}">#{$&}</a>}};s end<br/>
        def pg(m,n) {'get'=>%{<h1>WyRiki:<a href="wyriki?p=#{n}&amp;q=f">#{n}</a></h1><br/>
        (<a href="wyriki?p=#{n}&amp;q=e">edit me</a>)<p>#{fs(load(n))||n}},'edit'=><br/>
        %{<form action="wyriki?#{n}" method="POST"><h1>#{fs(n.dup)}<input type=}+<br/>
        %{"hidden" name="p" value="#{n}"> <input type="submit" value="save"></h1>}+<br/>
        %{<textarea name="t" rows="15" cols="80">#{load(n)||'Describe'}</textarea>}+<br/>
        %{</form>},'find'=>"<h1>Links: #{fs(n.dup)}</h1>"+fs(Dir['w/*'].select{ <br/>
        |fn| File.read(fn).include?(n)}.collect{|s|"\n* "+s[2..-1]}.join)}[m] end<br/>
        def main(f) n=f['p']||ENV['QUERY_STRING'].dup;n=(n=~/^[A-Za-z]+$/)?n:'HomePage'<br/>
        print "Content-type: text/html; charset=utf-8\r\n\r\n<title>#{n}</title>"<br/>
        open("w/"+n,"w"){|io|io.write f['t']} if ENV['REQUEST_METHOD']=='POST'<br/>
        print pg({'e'=>'edit', 'f'=>'find'}[f['q']] || 'get', n) end<br/>
        main Hash[ *CGI.new.params.collect{|k,v| [k,v[0]]}.flatten ] if __FILE__==$0<br/>
      </code>
      <hr/>
      <p>
        <a href="CategoryWikiImplementation.html">CategoryWikiImplementation</a>
      </p>
    </div>
  </body>
</html>