<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        The First Refactoring Step
      </h1>
      <p>
        <strong><em>These patterns are intended to be used by the community so it is the community the best suited for decide their content.</em></strong>
      </p>
      <hr/>
      <p>
        <em>"You should think of it (having tests before refactoring) as walking a tightrope without a net. If you are good at walking a tightrope, and it's not that high up, then you might try it. But if you've never walked a tightrope before, and it's over Niagara Falls, you probably want a good net" [1].</em>
      </p>
      <p>
        <strong>Pattern Name:</strong> The First Refactoring Step
      </p>
      <p>
        <strong>Problem</strong>
      </p>
      <p>
        How do you make sure you are ready to follow a refactoring process?
      </p>
      <p>
        <strong>Context</strong>
      </p>
      <p>
        You are developing software and you want to make some refactorings before continuing coding.
      </p>
      <p>
        <strong>Forces</strong>
      </p>
      <ul>
        <li>
           Finding errors through debugging can be a nightmare.
        </li>
        <li>
           Programmers need tools to validate the refactoring results.
        </li>
        <li>
           Building tests may sound counterintuitive to many programmers. 
        </li>
      </ul>
      <p>
        <strong>Solution</strong>
      </p>
      <p>
        Before you start refactoring, check that you have a solid suite of tests for the section of code that will be changed. 
      </p>
      <p>
        <strong>Resultant Context</strong>
      </p>
      <p>
        The use of this pattern together with the <a href="BacktrackIfRefactoringFails.html">BacktrackIfRefactoringFails</a> pattern give you the security you need to change a working program because "the tests provide immediate feedback when we broke something in the code" [4]. You can apply <a href="TestEveryRefactoring.html">TestEveryRefactoring</a> and <a href="RefactoringInVerySmallSteps.html">RefactoringInVerySmallSteps</a> to go forward.
      </p>
      <p>
        <strong>Rationale</strong>
      </p>
      <p>
        A set of tests is essential to applying refactorings because even though you follow <a href="RefactoringInVerySmallSteps.html">RefactoringInVerySmallSteps</a> to avoid chances for introducing errors, "(...) you're still human and still make mistakes" [2]. Also "even if you are fortunate enough to have a tool that can automate refactorings, you still need tests (...)" [2] because you could use the wrong refactoring to solve the problem.
      </p>
      <p>
        <strong>Origins</strong>
      </p>
      <p>
        The name of this pattern came from a subchapter in the Martin Fowler book [2] titled "The First Step in Refactoring". There, Martin exposed his point of view about the importance of having suite of tests before refactoring.
      </p>
      <p>
        Eric Burke and Brian Coyner wrote the following in their cookbook: "Refactoring works hand-in-hand with automated unit testing. Before you refactor code, make sure you have a working unit test on hand" [3].
      </p>
      <p>
        <strong>Acknowledgments</strong>
      </p>
      <ul>
        <li>
           Jonathan Rasmusson from Calgary, Alberta, Canada.
        </li>
      </ul>
      <p>
        <strong>References</strong>
      </p>
      <p>
        [1] Bill Venners. Refactoring with Martin Fowler. A Conversation with Martin Fowler. Available at: <a href="http://www.artima.com/intv/refactorP.html.">http://www.artima.com/intv/refactorP.html.</a> 2002. Last confirmed: July 01, 2004.
      </p>
      <p>
        [2] Martin Fowler, Kent Beck, John Brant, William Opdyke, Don Roberts. Refactoring: Improving the Design of Existing Code. Addison - Wesley, 1999.
      </p>
      <p>
        [3] Eric M. Burke, Brian M. Coyner. Java Extreme Programming Cookbook. O'Reilly, 2003.
      </p>
      <p>
        [4] Jonathan Rasmusson. Introducing XP into Greenfield Projects: Lessons Learned. IEEE Software, 20 (3), pp. 21-28. May / June, 2003.
      </p>
      <p>
        <strong>Author:</strong> SantiagoValdarrama
      </p>
      <hr/>
      <p>
        <strong>See Also:</strong> 
      </p>
      <ul>
        <li>
           <a href="AboutRefactoringPatterns.html">AboutRefactoringPatterns</a>
        </li>
        <li>
           <a href="BacktrackIfRefactoringFails.html">BacktrackIfRefactoringFails</a>
        </li>
        <li>
           <a href="RefactoringInVerySmallSteps.html">RefactoringInVerySmallSteps</a>
        </li>
        <li>
           <a href="TestEveryRefactoring.html">TestEveryRefactoring</a>
        </li>
        <li>
           <a href="RefactoringInDuets.html">RefactoringInDuets</a>
        </li>
        <li>
           <a href="RefactoringUsingTools.html">RefactoringUsingTools</a> 
        </li>
      </ul>
      <hr/>
      <p>
        Since most code doesn't have any tests, this means most code can't be refactored.
        But if you just decide to write tests, you'll discover that many systems are hard
        to tests if you don't start testing until after the system has been built.
        In practice, people write a few tests, refactor a little, write some more tests,
        refactor some more, etc.  But it is still a pain in the neck.  Refactoring is much
        easier if you have good tests.  -<a href="RalphJohnson.html">RalphJohnson</a>
      </p>
      <hr/>
      <p>
        Considering a big refactoring, such as decoupling conditionals (say for a database backend) strewn all about ugly code with no tests being refactored into a strategy pattern, there is no problem with code a little test, do a little refactor, commit, code a little test, do a little refactor, commit.  It works well, from experience (<a href="http://eraserhead.net/sugarsuite-postgres/).">http://eraserhead.net/sugarsuite-postgres/).</a>  --<a href="JasonFelice.html">JasonFelice</a>
      </p>
      <hr/>
      <p>
        <a href="CategoryRefactoring.html">CategoryRefactoring</a>
        <a href="CategoryPattern.html">CategoryPattern</a>s 
      </p>
    </div>
  </body>
</html>