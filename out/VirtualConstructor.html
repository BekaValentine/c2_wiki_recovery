<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Virtual Constructor
      </h1>
      <p>
        Used to create an object with the exact type given at runtime. The general type may be assumed.
      </p>
      <p>
        See:
      </p>
      <p>
        <a href="http://www1.bell-labs.com/user/cope/Patterns/C%2b%2bIdioms/EuroPLoP98.html#VirtualConstructor">http://www1.bell-labs.com/user/cope/Patterns/C%2b%2bIdioms/EuroPLoP98.html#VirtualConstructor</a>
      </p>
      <hr/>
      <p>
        OK, that's interesting. In <a href="ObjectPascal.html">ObjectPascal</a>, I found this:
      </p>
      <p>
        <em>The most notable feature of </em><a href="ObjectPascal.html">ObjectPascal</a> as in Delphi is the use of type variable, and through type variables the usage of <a href="VirtualConstructor.html">VirtualConstructor</a> (yes you can declare a constructor virtual in Delphi). As far as I know there's no other OO typed language having such a useful feature. <em></em>
      </p>
      <p>
        If I have this right, it seems that the <a href="VirtualConstructor.html">VirtualConstructor</a> is a feature of <a href="DelphiLanguage.html">DelphiLanguage</a>, but has to be implemented using some sort of support class in other languages.
      </p>
      <p>
        So we might have
      </p>
      <code>
        TFoo = class<br/>
        public<br/>
        constructor Create; virtual;<br/>
        end;<br/>
      </code>
      <code>
        TBar = class(TFoo);<br/>
        public<br/>
        constructor Create; override;<br/>
        end;<br/>
      </code>
      <code>
        TFooClass = class of TFoo; //declares a class reference type<br/>
      </code>
      <code>
        ...<br/>
      </code>
      <code>
        var<br/>
        fc: TFooClass;<br/>
        afoo: TFoo;<br/>
        begin<br/>
        fc := TFoo;<br/>
        afoo := fc.Create; // returns a TFoo<br/>
      </code>
      <code>
        ...<br/>
      </code>
      <code>
        fc := TBar;<br/>
        afoo := fc.Create; // returns a TBar<br/>
      </code>
      <code>
        {contrived example - we could just call TFoo.Create or TBar.Create in these cases}<br/>
      </code>
      <code>
        end;<br/>
      </code>
      <p>
        There must be similar features in other typed languages surely?
      </p>
      <hr/>
      <p>
        If you think you need a <a href="VirtualConstructor.html">VirtualConstructor</a>, you may be better off with a <a href="ClassFactory.html">ClassFactory</a>.
      </p>
      <hr/>
      <p>
        <a href="VirtualConstructor.html">VirtualConstructor</a> is also a nickname for the <a href="FactoryMethodPattern.html">FactoryMethodPattern</a> in the <a href="DesignPatternsBook.html">DesignPatternsBook</a>
      </p>
      <hr/>
      <p>
        <a href="ClassFactory.html">ClassFactory</a> is needed when there's no support for strong typed <a href="MetaClassVariable.html">MetaClassVariable</a>
        with inheritance support and <a href="VirtualMetaClassMethod.html">VirtualMetaClassMethod</a>
      </p>
      <p>
        <a href="MetaClassVariable.html">MetaClassVariable</a> are especially useful in InitializationSequence, allowing to build 
        sets of ClassRepository
      </p>
    </div>
  </body>
</html>