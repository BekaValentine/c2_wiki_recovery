<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <base href="/mount/ultralaser_home/Projects/c2_wiki_recovery/out/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="page">
      <h1>
        <img src="wiki.gif" />
        Rename Class In Vb Classic
      </h1>
      <p>
        How to rename a class in <a href="VbClassic.html">VbClassic</a>:
      </p>
      <hr/>
      <p>
        Doing the <a href="RenameClass.html">RenameClass</a> refactoring involves more than just a global search and replace when you're using <a href="VbClassic.html">VbClassic</a>:
      </p>
      <p>
        Here's a quick and easy way to do it:
      </p>
      <ol>
        <li>
           Copy the original class into a new .cls file
        </li>
        <li>
           Do the search-replace
        </li>
        <li>
           Run the tests
        </li>
        <li>
           Check in the new file
        </li>
        <li>
           Delete the old file from the project
        </li>
        <li>
           Check in the project file
        </li>
        <li>
           Delete the old file from source control and the file system.
        </li>
      </ol>
      <p>
        The advantage is that once the new file is set up and working, you can do the rest without worrying about breaking anything.
      </p>
      <p>
        <em>This will probably work better, in the presence of labels and other advanced usage, than renaming.  Few source code control products are very good at handling rename operations.  OTOH, it may be a little more difficult to see the history of changes to a given class.</em>
      </p>
      <p>
        Oops, good point.
      </p>
      <hr/>
      <p>
        Here's a slightly more complex but more "air tight" way to do it -- particularly if your <a href="VersionControl.html">VersionControl</a> software supports "rename" operations:
      </p>
      <ol>
        <li>
           Ensure that you have write access to the class and all files that reference it.  (Typically, this means that you must "check out" these files.)
        </li>
        <li>
           In the class' properties, change the class' name.
        </li>
        <li>
           Do a search and replace, changing the old class name to the new one.  Typically, you'll search and replace the whole of the current project.  If it's an externally visible class or interface, you'll have to search and replace in other projects.
        </li>
      </ol>
      <p>
        At this point the system should compile and successfully pass all <a href="UnitTest.html">UnitTest</a>s.
      </p>
      <p>
        But the file name for the class no longer matches its class name.
        When checking in your changes, a good approach is...
      </p>
      <ol>
        <li>
           Remember to check in the project (.vbp) file last.
        </li>
        <li>
           Check in the class whos name is changing.  You can enter checkin comments that you're changing the class' name.
        </li>
        <li>
           Delete the class from the project.
        </li>
        <li>
           Rename the class in the source code control system.
        </li>
        <li>
           Rename the class in the file system.
        </li>
        <li>
           Add the class back into the project.  (Add -> Class Module, Existing, open the file with the new name)
        </li>
        <li>
           When finished, check in the project file.
        </li>
      </ol>
      <hr/>
      <p>
        <a href="VbClassic.html">VbClassic</a> will become confused when you check out files in the middle of a project-wide search:
        It will report that you've found all instances, when you really haven't.
        So, you'll either have to do another round of searching, or rely on another method, such as bookmarks or open windows to keep track of what files need to be checked out.
      </p>
      <p>
        A similar process can be used to rename projects, when project group files are being used.
      </p>
      <hr/>
      <p>
        In the instructions above, I've documented the "safe, sane, rational" way to do it.
        To be honest, I normally open the project file in Notepad or VIM and edit it by hand.
        -- <a href="JeffGrigg.html">JeffGrigg</a>
      </p>
      <hr/>
      <p>
        <a href="CategoryRefactoring.html">CategoryRefactoring</a>, <a href="CategoryVbClassic.html">CategoryVbClassic</a>
      </p>
    </div>
  </body>
</html>