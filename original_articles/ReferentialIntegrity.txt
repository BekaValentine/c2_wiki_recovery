Isn't this the property of an RDBMS schema and its stored procedures that they never violate the constraints specified by the exported keys?

Yes. Got nothin' to do with ReferentialTransparency.
